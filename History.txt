Revision: 0000000000000000000000000000000000000000
Author: 
Date: 12/31/1969 5:00:00 PM
Message:
Working dir changes

3 files changed
----
Modified : History.txt
Modified : composite_primary_keys.gemspec
Modified : lib/composite_primary_keys/version.rb

Revision: b4a1523984fe51fd75a9283eaea6ee243c8890fa
Author: Charlie Savage
Date: 10/19/2011 8:19:03 PM
Message:
Merge pull request #73 from tomhughes/master

Make polymorphic belongs_to work in rails 3.1.1
----
Modified : lib/composite_primary_keys/associations/association_scope.rb

Revision: 2ce5b3e7d122ccbfba1b8c8a63c89bc0e9d31e60
Author: Tom Hughes
Date: 10/7/2011 1:43:51 PM
Message:
Update for changes to polymorphic belongs_to in rails 3.1.1


----
Modified : lib/composite_primary_keys/associations/association_scope.rb

Revision: f8e39c5e882dfab10d536480a1e9ce510ab5ec82
Author: Charlie Savage
Date: 9/23/2011 12:44:27 PM
Message:
Merge pull request #67 from rsutphin/no_relative_paths

Eliminate relative paths from the test suite.
----
Modified : test/abstract_unit.rb
Modified : test/test_associations.rb
Modified : test/test_attribute_methods.rb
Modified : test/test_attributes.rb
Modified : test/test_composite_arrays.rb
Modified : test/test_create.rb
Modified : test/test_delete.rb
Modified : test/test_dup.rb
Modified : test/test_equal.rb
Modified : test/test_exists.rb
Modified : test/test_find.rb
Modified : test/test_habtm.rb
Modified : test/test_ids.rb
Modified : test/test_miscellaneous.rb
Modified : test/test_pagination.rb
Modified : test/test_polymorphic.rb
Modified : test/test_predicates.rb
Modified : test/test_santiago.rb
Modified : test/test_suite.rb
Modified : test/test_tutorial_example.rb
Modified : test/test_update.rb
Modified : test/test_validations.rb
Modified : .gitignore
Modified : composite_primary_keys.gemspec
Modified : test/README_tests.txt
Modified : test/abstract_unit.rb
Modified : test/connections/databases.example.yml
Deleted : test/connections/databases.yml
Modified : test/fixtures/comments.yml
Modified : test/fixtures/db_definitions/mysql.sql
Modified : test/fixtures/db_definitions/oracle.drop.sql
Modified : test/fixtures/db_definitions/oracle.sql
Modified : test/fixtures/db_definitions/postgresql.sql
Modified : test/fixtures/db_definitions/sqlite.sql
Modified : test/fixtures/hack.rb
Modified : test/fixtures/hacks.yml
Modified : test/fixtures/reference_type.rb
Modified : test/test_associations.rb
Modified : test/test_attribute_methods.rb
Modified : test/test_polymorphic.rb

Revision: ae04762c17d2c81228e2d8f82634f2b8d9e08eac
Author: Charlie Savage
Date: 9/23/2011 12:43:26 PM
Message:
Merge pull request #71 from rsutphin/clean_test_runner_no_rel

Minor improvements to the CPK test runner w/o relative path changes
----
Modified : .gitignore
Modified : composite_primary_keys.gemspec
Modified : test/README_tests.txt
Modified : test/abstract_unit.rb
Modified : test/connections/databases.example.yml
Deleted : test/connections/databases.yml
Modified : test/fixtures/reference_type.rb

Revision: 4d539868f58e4b8cf7a771da7b92f4dd651cf343
Author: Rhett Sutphin
Date: 9/19/2011 11:00:25 AM
Message:
Remove stray puts.


----
Modified : test/fixtures/reference_type.rb

Revision: d229c75b7b4fb08658c3b9a655a705cb55556a17
Author: Rhett Sutphin
Date: 9/19/2011 10:55:56 AM
Message:
Allow AR logs to go to a file when running tests.

The test runner configures ActiveRecord to send its messages to STDOUT. This
is helpful for debugging, but a lot of noise if you're just trying to see if
everything passed. This commit allows you to specify a file to use instead
via the CPK_LOGFILE environment variable. (STDOUT is still the default.)
----
Modified : test/README_tests.txt
Modified : test/abstract_unit.rb

Revision: 5a2de3eb6c4cd1487685c925acaa7119bbc5d92b
Author: Rhett Sutphin
Date: 9/19/2011 10:24:56 AM
Message:
Use ADAPTER env variable to select database to test.

Commit 579c29fe0ee9a881ca3ecf89f58820796a716a26 changed the test setup in
abstract_unit so that it used the first adapter in databases.yml
(as presented by the YAML parser; not necessarily the first one in the file),
rather than looking at the ADAPTER env variable. This change broke the
database-specific rake tasks (they would run against the database selected
by databases.yml rather than the one the user requested) and made parts of the
testing README incorrect.

This commit restores the ability to use the ADAPTER env var to select a
database to test against. This works in both the rake tasks and when running
from the command line:

    ADAPTER=sqlite3 ruby test/test_suite.rb

The default adapter is `postgresql`, as was previously the case.

Incidentally, this commit also removes & ignores the committed
test/connections/databases.yml file in preference to the (existing)
databases.examples.yml file. This change will make it easier for contributors
to avoid accidentally contributing changes to the test database configuration.
----
Modified : .gitignore
Modified : test/README_tests.txt
Modified : test/abstract_unit.rb
Modified : test/connections/databases.example.yml
Deleted : test/connections/databases.yml

Revision: df3408db296eca14707161268440d19c1c6bfb40
Author: Rhett Sutphin
Date: 9/19/2011 10:07:58 AM
Message:
Eliminate constant redef warnings during test runs.

Under ruby 1.8, requires are only tracked by the literal path that's passed
to `require`. This commit ensures that `'composite_primary_keys/version'` is
only ever required by that specific path, preventing its contents from being
redefined when the test suite is loaded.
----
Modified : composite_primary_keys.gemspec
Modified : test/abstract_unit.rb

Revision: 07389e084fef1427bde01fe9dbcde52505a1301a
Author: Charlie Savage
Date: 9/21/2011 9:31:13 PM
Message:
Merge pull request #70 from rsutphin/missing_fixture_decl

Add missing fixture declarations.
----
Modified : test/test_associations.rb
Modified : test/test_attribute_methods.rb
Modified : test/fixtures/comments.yml
Modified : test/fixtures/db_definitions/mysql.sql
Modified : test/fixtures/db_definitions/oracle.drop.sql
Modified : test/fixtures/db_definitions/oracle.sql
Modified : test/fixtures/db_definitions/postgresql.sql
Modified : test/fixtures/db_definitions/sqlite.sql
Modified : test/fixtures/hack.rb
Modified : test/fixtures/hacks.yml
Modified : test/test_polymorphic.rb

Revision: a932c797dd0124e27058b3705763ca8f9ade7007
Author: Charlie Savage
Date: 9/21/2011 9:28:58 PM
Message:
Merge pull request #69 from rsutphin/postgresql_83

Fix polymorphic test failure on PostgreSQL 8.3+ and Oracle
----
Modified : test/fixtures/comments.yml
Modified : test/fixtures/db_definitions/mysql.sql
Modified : test/fixtures/db_definitions/oracle.drop.sql
Modified : test/fixtures/db_definitions/oracle.sql
Modified : test/fixtures/db_definitions/postgresql.sql
Modified : test/fixtures/db_definitions/sqlite.sql
Modified : test/fixtures/hack.rb
Modified : test/fixtures/hacks.yml
Modified : test/test_polymorphic.rb

Revision: 4e6b005338e6bc9a6f363d36101aa36f9eba12eb
Author: Rhett Sutphin
Date: 9/21/2011 1:11:05 PM
Message:
Add missing fixture declarations.

These two test cases were missing declarations for some of the fixtures on
which they rely. This caused them to confusingly fail the first time the
suite was executed after recreating the schema and then pass thereafter.
----
Modified : test/test_associations.rb
Modified : test/test_attribute_methods.rb

Revision: c3407f739841304ad949beab302494a83326dd07
Author: Rhett Sutphin
Date: 9/21/2011 11:12:03 AM
Message:
Standardize on integer PKs in polymorphic fixtures.

The mix of string and integer PKs and FKs in the comments table and the three
tables (employees, users, and hacks) to which it refers causes problems in
databases that do strict type checking in SELECTs. (Problems observed on
PostgreSQL 8.3+ and Oracle.) This commit makes all the FKs and PKs integers to
eliminate these problems.

N.b.: this commit includes changes to the test database schema; you will need
to rebuild your test database after applying it. There are no changes for the
db2 schema because it does not include the relevant tables. The changes to
the MySQL schema were not tested.
----
Modified : test/fixtures/comments.yml
Modified : test/fixtures/db_definitions/mysql.sql
Modified : test/fixtures/db_definitions/oracle.drop.sql
Modified : test/fixtures/db_definitions/oracle.sql
Modified : test/fixtures/db_definitions/postgresql.sql
Modified : test/fixtures/db_definitions/sqlite.sql
Modified : test/fixtures/hack.rb
Modified : test/fixtures/hacks.yml
Modified : test/test_polymorphic.rb

Revision: b1b7f8e84428b687345a625d23f48187f9649ee4
Author: Rhett Sutphin
Date: 9/19/2011 9:56:18 AM
Message:
Eliminate relative paths from the test suite.

Converting all wd-relative requires into file-relative requires allows the
test suite to be executed either from rake or directly, and from any
directory. All of the following now work:

    cd [cpk-root]
    rake postgresql:test
    ruby test/test_suite.rb
    cd test
    ruby test_suite.rb
----
Modified : test/abstract_unit.rb
Modified : test/test_associations.rb
Modified : test/test_attribute_methods.rb
Modified : test/test_attributes.rb
Modified : test/test_composite_arrays.rb
Modified : test/test_create.rb
Modified : test/test_delete.rb
Modified : test/test_dup.rb
Modified : test/test_equal.rb
Modified : test/test_exists.rb
Modified : test/test_find.rb
Modified : test/test_habtm.rb
Modified : test/test_ids.rb
Modified : test/test_miscellaneous.rb
Modified : test/test_pagination.rb
Modified : test/test_polymorphic.rb
Modified : test/test_predicates.rb
Modified : test/test_santiago.rb
Modified : test/test_suite.rb
Modified : test/test_tutorial_example.rb
Modified : test/test_update.rb
Modified : test/test_validations.rb

Revision: e1611b0c9d4d3f39155a2444b2b2df4e707c789e
Author: Charlie Savage
Date: 9/15/2011 8:49:50 PM
Message:
Merge branch 'master' of github.com:drnic/composite_primary_keys


----
Modified : README.txt
Modified : test/README_tests.txt
Modified : composite_primary_keys.gemspec
Modified : lib/composite_primary_keys.rb
Modified : lib/composite_primary_keys/version.rb

Revision: e249e44a12c3275fe4faa81cd37e75c494029a01
Author: Charlie Savage
Date: 9/13/2011 11:39:17 AM
Message:
Merge pull request #64 from backspace/master

Not that anyone would be confused
----
Modified : README.txt
Modified : test/README_tests.txt

Revision: bb364112dd8eefb7cdf1160a8d91585f19b149bc
Author: Buck
Date: 9/13/2011 11:27:58 AM
Message:
Fix tiny file name typos


----
Modified : README.txt
Modified : test/README_tests.txt

Revision: 5134091aee77fae0bf1dbb4d6657a7d528c1a0ac
Author: Charlie Savage
Date: 8/31/2011 1:19:52 PM
Message:
Bump to 4.0.0 for Rails 3.1 support.


----
Modified : composite_primary_keys.gemspec
Modified : lib/composite_primary_keys.rb
Modified : lib/composite_primary_keys/version.rb


== 4.0.0 August 31
* Support for AR 3.1

== 4.0.0.beta9 2011-08-22
* Fix eager-loading in AR 3.1.rc6.

== 4.0.0.beta9 2011-082-22
* Fix eager-loading in AR 3.1.rc6.

== 4.0.0.beta8 2011-082-22
* Sqlite 3 fixes (Jan Vlnas)
* Fixes for to_key method (Jan Vlnas)
* Compatible with Rails 3.1 RC6 (Ari Epstein, Travis Warlick)

== 4.0.0.beta7 2011-07-26
* Compatible with Rails 3.1 RC5 (TycoooN)
* Do not use Arel::Nodes::Or to combine predicates because it creates a
  deeply nested stack that blows up.

== 4.0.0.beta4 2011-07-22
* Compatible with Rails 3.1 stable branch.  No longer works with RC4 (Charlie Savage)
* Do not require loading of postgresql gem unless needed (Charlie Savage)

== 4.0.0.beta3 2011-07-08
* Fix the ability to update the values of a primary key (Travis Warlick)
* Support port and host configurations for postgres rake tasks (Travis Warlick)

== 4.0.0.beta2 2011-06-21
* ActiveRecord 3.1 RC4 compatibility.
* Fix instantiation of CPK models with included associations

== 4.0.0.beta1 2011-06-09
* ActiveRecord 3.1 RC1 compatibility.  This required a significant rewrite due to
  all the changes in AR 3.1 versus 3.0.

== 3.1.10 2011-07-08
* Bugfix for belongs_to with includes (John Ash)
* Improved tests for calling clear on a habtm association, which involved (David Rueck)
* Fixed bug that resulted in unrelated records being deleted when calling (David Rueck)
* Output deprecation warnings about extra columns in join table CPK-aware (David Rueck)


== 3.1.9 2011-06-04
* Improve HABTM association tests (David Rueck)
* Remove deprecated Rake tasks (Charlie Savage)

== 3.1.8 2011-05-26
* Fix calling clear on a HABTM associate (David Rueck)

== 3.1.7 2011-05-26
* Support regular AR models having one or many composite models (Jacques Fuentes)
* Minor test cleanup (Charlie Savage)
* Make version requirements more explicit (Charlie Savage)
* Remove Arel extensions used for calculations (Charlie Savage)
* Fix test that included wrong error constant

== 3.1.6 2011-04-03
* Updated belongs_to association to be a bit more flexible with non-CPK (Charlie Savage)
  base models (Jacques Fuentes)
* Fix uniqueness check (David Rueck)
* Fix write issue when one of they keys in a composite key is
  called id (Tom Hughes)


== 3.1.5 2011-03-24
* Fix simple calculation methods (Charlie Savage)
* Fix instantiation of cpk records via associations  (Charlie Savage)
* Fix Relation#delete (Charlie Savage)
* Fix Relation#destroy (Charlie Savage)


== 3.1.4 2011-03-06
* Support ActiveRecord 3.0.5 - interpolate_sql was removed and
  replaced by interpolate_and_sanitize_sql (Charlie Savage)
* Fix persistence methods to support destroy callbacks (Charlie Savage)
* Support rake 0.9.0 beta (Charlie Savage)


== 3.1.2 2011-02-26
* Add back in support for find('3,3') which makes it possible to
  do find(params[id]).  This implementation is simpler than earlier version
  improving code readability.
* Support for finding multiple records either via find([1,2], [3,4])
* Remove to_composite_ids method which is no longer needed


== 3.1.1 2011-02-07
* Implement id_before_type_cast (Jason Lewis)
* Add in tests for Model.includes(:other_model)
* Fix object comparison with nil in composite primary keys (StackNG)
* Make it easier to run tests with different database adapters (Toby Cabot)
* Fix AssociationReflection#primary_key_name for polymorphic relationships (Dave Doan)


== 3.1.0 2010-12-17
* Add back in rake test tasks (Toby Cabot)
* Add support for multiple string composite keys (wouter)
* Remove support for find('3,3').  Instead use find([3,3])


== 3.0.9 2010-12-04
* Fix up support for composite key fixtures.


== 3.0.8 2010-12-04
* Fix for translation issue in unique validation.  Thanks to Daniel Berger for the patch.
* Fix to support child classes of composite primary key models


== 3.0.7 2010-11-29
* Fix has and belongs to many associations implementation.


== 3.0.6 2010-11-29  (yanked)
* Add full support for has and belongs to many associations.


== 3.0.5 2010-11-28 (yanked)
* Apply patch from Marian Rudzynski for fixing up attribute_methods/primary_key
* Apply patch from Toby Cabot to fix up various sqlite3 issues
* Add partial support for has and belongs to many associations.  Currently a cpk model
  can have a habtm, but a normal model cannot have a habtm to a cpk model (its actually
  not too hard to add, but one step at a time...)


== 3.0.4 2010-11-21
* Support deleting records when dependent is set to :delete_all
* Switch the method #id to return a CompositeKeys instance (thus going back to how
  this was done in previous CPK versions)


== 3.0.3 2010-11-19
* Support ActiveRecord 3.0.3 and Arel 2+
* Require ActiveRecord 3.0.3 as minimum dependency
* Fix double quoting issue with table names - thanks to Kevin Motschiedler for a patch.
* Fix SQLiteAdapter class inheritance issue - thanks to Brandon Hauff for a patch.


== 3.0.1.b3 2010-11-07

* Fix bug in joining to :has_one association
* Added support for Model.find(:last)
* Added support for finding via associations with
  limited ids.  For example find(:include => :foo, :limit => 1)

== 3.0.1.b2 2010-11-06

* Port to Rails 3.0 and Ruby 1.9.2

* Backwards compatability issues
  + You can no longer define a composite primary key with a single field.  If you
    try, your model will just default to a standard active record model.  Removing
    this corner case simplified the code.
  + Removed CompositePrimaryKeys::CompositeKeys.  This was done so that the #to_s
    method on composite ids, such as [1,2], returns "[1, 2]".  This in turns
    reduces the amount of core Rails code that needs to be overridden.
  + Setting attribute values by string is no longer supported. For example, this
    no longer works:
      my_record[[:main_id, :secondary_id]] = '1,2'
    Instead, do  this:
      my_record[[:main_id, :secondary_id]] = [1,2]
    Once again, this was done to reduce the amount of overridden Rails code
  + At the moment, complex finds with nested arrays do not work.  For example
    find([[1,2], [3,4]))
  + Count methods no longer work.  For example, Tariff.count(:include => :product_tariffs)
    in the TestAssociations#test_count test returns an error.  This is because Rails 3.0
    uses Arel to perform such calculations, and its not obvious (at least to me) how to
    hook into this new mechanism to support tables with composite keys.
  + The TestPolymorphic#test_polymorphic_has_many_through is currently failing, but this
    looks like an ActiveRecord 3.0 bug to me.

== 2.3.5.1 2010-02-13

* Resolved "warning: already initialized constant HasManyThroughCantAssociateThroughHasManyReflection" [Titi Ala'ilima]

== 2.3.5 2009-12-16

* Fixed several bugs in has_one and has_many associations when :primary_key specified [kpumuk]

== 2.3.2 2009-07-16

* explicitly load associations.rb due to some getting an unitialized constant error

== 2.3.2 2009-05-28

* get tests working again with AR 2.3.2

== 2.2.1 2009-01-21

* fix ActiveRecord#exists? to work when passing conditions instead of ids

== 2.2.0 2008-10-29

* Rails 2.2.0 compatibility

== 1.1.0 2008-10-29

* fixes to get cpk working for Rails 2.1.2

== 1.0.10 2008-10-22

* add composite key where clause creator method [timurv]

== 1.0.9 2008-09-08

* fix postgres tests
* fix for delete_records when has_many association has composite keys [darxriggs]
* more consistent table/column name quoting [pbrant]

== 1.0.8 2008-08-27

* fix has_many :through for non composite models [thx rcarver]

== 1.0.7 2008-08-12

* fix for the last fix -- when has_many is composite and belongs_to is single

== 1.0.6 2008-08-06

* fix associations create

== 1.0.5 2008-07-25

* fix for calculations with a group by clause [thx Sirius Black]

== 1.0.4 2008-07-15

* support for oracle_enhanced adapter [thx Raimonds Simanovskis]

== 1.0.3 2008-07-13

* more fixes and tests for has many through [thx Menno van der Sman]

== 1.0.2 2008-06-07

* fix for has many through when through association has composite keys

== 1.0.1 2008-06-06

* Oracle fixes

== 1.0.0 2008-06-05

* Support for Rails 2.1

== 0.9.93 2008-06-01

* set fixed dependency on activerecord 2.0.2

== 0.9.92 2008-02-22

* Support for has_and_belongs_to_many

== 0.9.91 2008-01-27

* Incremented activerecord dependency to 2.0.2 [thx emmanuel.pirsch]

== 0.9.90 2008-01-27

* Trial release for rails/activerecord 2.0.2 supported

== 0.9.1 2007-10-28

* Migrations fix - allow :primary_key => [:name] to work [no unit test] [thx Shugo Maeda]

== 0.9.0 2007-09-28

* Added support for polymorphs [thx nerdrew]
* init.rb file so gem can be installed as a plugin for Rails [thx nerdrew]
* Added ibm_db support [thx K Venkatasubramaniyan]
* Support for cleaning dependents [thx K Venkatasubramaniyan]
* Rafactored db rake tasks into namespaces
* Added namespaced tests (e.g. mysql:test for test_mysql)

== 0.8.6 / 2007-6-12

* 1 emergency fix due to Rails Core change
  * Rails v7004 removed #quote; fixed with connection.quote_column_name [thx nerdrew]

== 0.8.5 / 2007-6-5

* 1 change due to Rails Core change
  * Can no longer use RAILS_CONNECTION_ADAPTERS from Rails core
* 7 dev improvement:
  * Changed History.txt syntax to rdoc format
  * Added deploy tasks
  * Removed CHANGELOG + migrated into History.txt
  * Changed PKG_NAME -> GEM_NAME in Rakefile
  * Renamed README -> README.txt for :publish_docs task
  * Added :check_version task
  * VER => VERS in rakefile
* 1 website improvement:
  * website/index.txt includes link to "8 steps to fix other ppls code"

== 0.8.4 / 2007-5-3

* 1 bugfix
  * Corrected ids_list => ids in the exception message. That'll teach me for not adding unit tests before fixing bugs.

== 0.8.3 / 2007-5-3

* 1 bugfix
  * Explicit reference to ::ActiveRecord::RecordNotFound
* 1 website addition:
  * Added routing help [Pete Sumskas]

== 0.8.2 / 2007-4-11

* 1 major enhancement:
  * Oracle unit tests!! [Darrin Holst]
  * And they work too

== 0.8.1 / 2007-4-10

* 1 bug fix:
  * Fixed the distinct(count) for oracle (removed 'as')

== 0.8.0 / 2007-4-6

* 1 major enhancement:
  * Support for calcualtions on associations
* 2 new DB supported:
  * Tests run on sqlite
  * Tests run on postgresql
* History.txt to keep track of changes like these
* Using Hoe for Rakefile
* Website generator rake tasks

== 0.3.3
* id=
* create now work

== 0.1.4
* it was important that #{primary_key} for composites --> 'key1,key2' and not 'key1key2' so created PrimaryKeys class

== 0.0.1
* Initial version
* set_primary_keys(*keys) is the activation class method to transform an ActiveRecord into a composite primary key AR
* find(*ids) supports the passing of
  * id sets: Foo.find(2,1),
  * lists of id sets: Foo.find([2,1], [7,3], [8,12]),
  * and even stringified versions of the above:
  * Foo.find '2,1' or Foo.find '2,1;7,3'
